<ion-header *ngIf="page == 1">
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-button (click)="dismiss()">
        <ion-icon slot="icon-only" name="arrow-back-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>add groups</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-no-padding" *ngIf="page == 1">
  <ion-card class="form-card">
    <ion-card-header>
      <ion-card-title class="title">Create groups</ion-card-title>
    </ion-card-header>

      <!-- Thumbnail Upload -->
      <div class="thumbnail-section">
      <ion-label>Select Thumbnail</ion-label>
      <input
        hidden
        type="file"
        accept="image/*"
        id="thumbnailInput"
        (change)="onThumbnailFileChange($event)"
      />

      <div *ngIf="img_show; else uploadBtn" class="thumbnail-preview">
        <img [src]="img_show" alt="Thumbnail Preview" />
        <ion-fab vertical="top" horizontal="end" slot="fixed">
          <ion-fab-button size="small" color="danger" (click)="clearThumbnail()">
            <ion-icon name="trash-outline"></ion-icon>
          </ion-fab-button>
        </ion-fab>
      </div>

      <ng-template #uploadBtn >
        <div style="display: flex;justify-content: center;align-items: center;">
          <ion-button expand="block" shape="round" style="width: 50%;" (click)="triggerFileInput()">
            <ion-icon slot="start" name="image-outline"></ion-icon>
            Upload Thumbnail
          </ion-button>
        </div>
      </ng-template>
    </div>

    <div class="map" id="mapId" style="height: 200px;"></div>
    <ion-button color="primary" class="mylo" (click)="mylo()">
      <ion-icon slot="icon-only" name="location-sharp"></ion-icon>
    </ion-button>

    
    
    <ion-card-content>

      <!-- <ion-item class="input-item">
        <ion-label>lat:{{newGroup?.lat}}  lng:{{newGroup?.lng}}</ion-label>
      </ion-item> -->

      <ion-item class="input-item">
        <ion-label position="floating">Name Group</ion-label>
        <ion-input type="text" [(ngModel)]="newGroup.name"></ion-input>
      </ion-item>

      <!-- <ion-item class="input-item">
        <ion-label>Package</ion-label>
        <ion-select [(ngModel)]="newGroup.packages" interface="popover" placeholder="Select Package">
          <ion-select-option *ngFor="let package of schedulePackages" [value]="package.id">{{ package?.name }}</ion-select-option>
        </ion-select>
      </ion-item> -->

      <ion-item  class="input-item" (click)="openPackageSelector()">
        <ion-label>Packages</ion-label>
        <ion-text slot="end">
          {{ newGroup.description.packages?.length ? newGroup.description.packages.length + ' selected' : 'Select Packages' }}
        </ion-text>
      </ion-item>

      <ion-button *ngIf="title == 'add'" expand="block" shape="round" color="primary" class="add-button" (click)="addGroup()">
        <ion-icon name="add-circle-outline" slot="start"></ion-icon>
        Add groups
      </ion-button>
      <ion-button *ngIf="title == 'edit'" expand="block" shape="round" color="warning" class="edit-button" (click)="EditGroup()">
        <ion-icon name="add-circle-outline" slot="start"></ion-icon>
        Edit groups
      </ion-button>
    </ion-card-content>
  </ion-card>
</ion-content>

<!-- ================================= page 2  -->

<ion-header *ngIf="page == 2">
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-button (click)="close()">
        <ion-icon slot="icon-only" name="arrow-back-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>Select Package</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="Done()">Done</ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>


<ion-content class="ion-no-padding" *ngIf="page == 2">
  <ion-list>
    <ion-item *ngFor="let pkg of schedulePackages">
      <ion-checkbox
        slot="start"
        [checked]="check_package(pkg?.id)"
        (ionChange)="toggleSelection(pkg?.id, $event.detail.checked)">
      </ion-checkbox>
      <ion-label>
        <h2>ID: {{ pkg.id }}</h2>
        <h2>Name: {{ pkg.name }}</h2>
        <p>Price: {{ pkg.price | number }}</p>
      </ion-label>
    </ion-item>
  </ion-list>
</ion-content>
