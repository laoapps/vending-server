# Tasmota API Test File
# Base URL: https://smartcb-api.laoapps.com
# Replace <token>, <jwt_token>, <device_id>, <group_id>, <schedule_id>, <package_id>, <user_token> with actual values
@jwt_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJkYXRhIjp7InNpZ25hdHVyZSI6IjA0Nzk0ZGYwZGZkZTYxNWQ3ZjE1YjNlMTFjZTgzYzQzY2M1YjQ1MGI2NDY5MDQzYzUzNmVhYTUwMTk3MzExMWYzNmFmN2FhM2VkN2M5OTlkZTg2YTY3MWVmYjRiNTFhZTM2NzgwZjhiYmNlNjA3ZWFmOGYwZDYxMDg2YmM4NDg4NGMiLCJwaG9uZU51bWJlciI6Iis4NTYyMDU1NTE2MzIxIiwidXVpZCI6Ijg2MmY5NmEwLWFjNDUtMTFlZC1hZjA0LTU1ZmE3ZTc0ZTE5NCIsImlwIjoiMTkyLjE2OC44OC44MSIsIm1hY2hpbmUiOiJ3aW5kb3dzIiwib3RoZXJpbmZvIjoibGFvYXBwLmNvbSIsImxvY2F0aW9uIjoidmllbnRpYW5lIn0sImlhdCI6MTc0Njc4MDM1MCwiZXhwIjozNjAwMDAwMTc0Njc4MDM1MH0.JrBLY6pMgzL9iAIoZ1LFzCRWtxvHYUzvsSd2LHEh2xE

### Register Owner
POST https://smartcb-api.laoapps.com/api/auth/register-owner
Content-Type: application/json

{
  "token": "{{jwt_token}}"
}

> {% client.global.set("jwt_token", response.body.token); %}

### List Devices (Admin/Owner/Client)
GET https://smartcb-api.laoapps.com/api/devices
Authorization: Bearer {{jwt_token}}

### Create Device (Owner)
POST https://smartcb-api.laoapps.com/api/devices
Content-Type: application/json
Authorization: Bearer {{jwt_token}}

{
  "name": "Test Device",
  "tasmotaId": "tongou_3B0444",
  "zone": "Living Room"
}

### Update Device (Owner)
PUT https://smartcb-api.laoapps.com/api/devices/<device_id>
Content-Type: application/json
Authorization: Bearer {{jwt_token}}

{
  "name": "Updated Device",
  "tasmotaId": "tongou_3B0444",
  "zone": "Kitchen"
}

### Delete Device (Owner)
DELETE https://smartcb-api.laoapps.com/api/devices/<device_id>
Authorization: Bearer {{jwt_token}}

### Control Device (Admin/Owner/Client)
POST https://smartcb-api.laoapps.com/api/devices/control
Content-Type: application/json
Authorization: Bearer {{jwt_token}}

{
  "deviceId": <device_id>,
  "command": "POWER TOGGLE"
}

### Assign Device to User (Owner)
POST https://smartcb-api.laoapps.com/api/devices/assign
Content-Type: application/json
Authorization: Bearer {{jwt_token}}

{
  "deviceId": <device_id>,
  "token": "<user_token>"
}

### List Groups (Admin/Owner)
GET https://smartcb-api.laoapps.com/api/groups
Authorization: Bearer {{jwt_token}}

### Create Group (Owner)
POST https://smartcb-api.laoapps.com/api/groups
Content-Type: application/json
Authorization: Bearer {{jwt_token}}

{
  "name": "Test Group"
}

### Update Group (Owner)
PUT https://smartcb-api.laoapps.com/api/groups/<group_id>
Content-Type: application/json
Authorization: Bearer {{jwt_token}}

{
  "name": "Updated Group"
}

### Delete Group (Owner)
DELETE https://smartcb-api.laoapps.com/api/groups/<group_id>
Authorization: Bearer {{jwt_token}}

### Assign Device to Group (Owner)
POST https://smartcb-api.laoapps.com/api/groups/assign
Content-Type: application/json
Authorization: Bearer {{jwt_token}}

{
  "groupId": <group_id>,
  "deviceId": <device_id>
}

### List Schedules (Admin/Owner/Client)
GET https://smartcb-api.laoapps.com/api/schedules
Authorization: Bearer {{jwt_token}}

### Create Schedule (Owner)
POST https://smartcb-api.laoapps.com/api/schedules
Content-Type: application/json
Authorization: Bearer {{jwt_token}}

{
  "deviceId": <device_id>,
  "type": "timer",
  "cron": "0 7 * * *",
  "command": "POWER ON"
}

### Update Schedule (Owner)
PUT https://smartcb-api.laoapps.com/api/schedules/<schedule_id>
Content-Type: application/json
Authorization: Bearer {{jwt_token}}

{
  "deviceId": <device_id>,
  "type": "conditional",
  "command": "POWER OFF",
  "conditionType": "power_overload",
  "conditionValue": 1000,
  "active": true
}

### Delete Schedule (Owner)
DELETE https://smartcb-api.laoapps.com/api/schedules/<schedule_id>
Authorization: Bearer {{jwt_token}}

### Apply Schedule Package (Owner/Client)
POST https://smartcb-api.laoapps.com/api/schedule-packages/apply-package
Content-Type: application/json
Authorization: Bearer {{jwt_token}}

{
  "deviceId": <device_id>,
  "packageId": <package_id>
}

### List Schedule Packages (Admin/Owner/Client)
GET https://smartcb-api.laoapps.com/api/schedule-packages
Authorization: Bearer {{jwt_token}}

### Create Schedule Package (Owner)
POST https://smartcb-api.laoapps.com/api/schedule-packages
Content-Type: application/json
Authorization: Bearer {{jwt_token}}

{
  "name": "Test Package",
  "durationMinutes": 30,
  "powerConsumptionWatts": 1000,
  "price": 10
}

### Update Schedule Package (Owner)
PUT https://smartcb-api.laoapps.com/api/schedule-packages/<package_id>
Content-Type: application/json
Authorization: Bearer {{jwt_token}}

{
  "name": "Updated Package",
  "durationMinutes": 60,
  "powerConsumptionWatts": 1500,
  "price": 15
}

### Delete Schedule Package (Owner)
DELETE https://smartcb-api.laoapps.com/api/schedule-packages/<package_id>
Authorization: Bearer {{jwt_token}}

### View All Data (Admin)
GET https://smartcb-api.laoapps.com/api/admin
Authorization: Bearer {{jwt_token}}
X-Admin-Key: super-admin

### List Owners (Admin)
GET https://smartcb-api.laoapps.com/api/owners
Authorization: Bearer {{jwt_token}}
X-Admin-Key: super-admin