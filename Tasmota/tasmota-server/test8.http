# test.http
# Test file for Tasmota API endpoints
# Use with VS Code REST Client or similar tools
# Replace placeholders: {{jwtToken}}, {{userUuid}}, {{ownerUuid}}, {{ownerId}}, {{deviceId}}, {{packageId}}, {{orderId}}, {{transId}}, {{tasmotaId}}
@jwtToken=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJkYXRhIjp7InNpZ25hdHVyZSI6IjA0Nzk0ZGYwZGZkZTYxNWQ3ZjE1YjNlMTFjZTgzYzQzY2M1YjQ1MGI2NDY5MDQzYzUzNmVhYTUwMTk3MzExMWYzNmFmN2FhM2VkN2M5OTlkZTg2YTY3MWVmYjRiNTFhZTM2NzgwZjhiYmNlNjA3ZWFmOGYwZDYxMDg2YmM4NDg4NGMiLCJwaG9uZU51bWJlciI6Iis4NTYyMDU1NTE2MzIxIiwidXVpZCI6Ijg2MmY5NmEwLWFjNDUtMTFlZC1hZjA0LTU1ZmE3ZTc0ZTE5NCIsImlwIjoiMTkyLjE2OC44OC44MSIsIm1hY2hpbmUiOiJ3aW5kb3dzIiwib3RoZXJpbmZvIjoibGFvYXBwLmNvbSIsImxvY2F0aW9uIjoidmllbnRpYW5lIn0sImlhdCI6MTc1NTc2MTAzOSwiZXhwIjozNjAwMDAwMTc1NTc2MTA0MH0.1xnc-ITa4NqPRAD3mKoHS3p8TFhGxQQnvFwF6zrU01A
@binryToken=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJkYXRhIjp7InNpZ25hdHVyZSI6IjA0YmI0OTg3YjJiMTQ5YmY3ZGI2NjE1Y2RlMzFjMzZhOTQ4MjEyM2M0Y2I1YzFkMGNhYWRhY2NjMWFhZGU2MjY4YjY4YmQ4YTUxNmI0NzY3ZTRmOGU4MDk3OTk3YWM0ZjIwMTM3ZTg5ZmM3MDJhMWNlMjc5NGQ5NjhhNjZjMWU3ZGIiLCJwaG9uZU51bWJlciI6Iis4NTYyMDk2MTIzMzgxIiwidXVpZCI6IjllYzM1MTUwLWIyN2QtMTFlZC05M2JkLWM5M2ZiMDNkMWZjMiIsImlwIjoiMTkyLjE2OC44OC44MSIsIm1hY2hpbmUiOiJ3aW5kb3dzIiwib3RoZXJpbmZvIjoibGFvYXBwLmNvbSIsImxvY2F0aW9uIjoidmllbnRpYW5lIn0sImlhdCI6MTc1NTc1OTQ2NCwiZXhwIjozNjAwMDAwMTc1NTc1OTQ2NH0.1CfeHjhamoXfDkoRLdtCJzld_WnLhA76xaB9Q0jGiJE
@suckToken=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJkYXRhIjp7InNpZ25hdHVyZSI6IjA0Y2U0Mzg3MzBlNDA1YmNhYTg4YWUwNjQ4MGMwOGVkZGY2MWMzNDkwYzM5ZjUwOWIwOTcyMGZkNjkyMmMwYjA2OWMzNGIyZjZjYmY3YmVlMzM2MjkwZDViYzA4YTZiNmEzNzkwNjU3NzQ2YWJjNGNhZTFkNGUyYjJjMGI3YTQ3OTYiLCJwaG9uZU51bWJlciI6Iis4NTYyMDc2MTQzNTE1IiwidXVpZCI6IjVmOTMzMWUwLTM1MDctMTFlZi05NmM0LTk3ZmVjOWM4NzE0ZiIsImlwIjoiMTkyLjE2OC44OC44MSIsIm1hY2hpbmUiOiJ3aW5kb3dzIiwib3RoZXJpbmZvIjoibGFvYXBwLmNvbSIsImxvY2F0aW9uIjoidmllbnRpYW5lIn0sImlhdCI6MTc2NTQ0Njk4MCwiZXhwIjozNjAwMDAwMTc2NTQ0Njk4MH0.fjCiy34h3uOfJTxwGDNwlUsX3s77-_VFncQSP5VOmpQ
@tasmotaId=tongou_3B0444
@ownerUuid=86f96a0-ac45-11ed-af04-55fa7e74e194
@ownerId=1
@userUuid=123e4567-e89b-12d3-a456-426614174000
@deviceId=1
@packageId=1
@orderId=1
@transId=1234567890abcdef
@host=smartcb-api.laoapps.com
#Device Servicesrc/services/deviceService.tstypescriptâ€¢Test HTTP Filetext# test.http
# Test file for Tasmota API endpoints
# Use with VS Code REST Client or similar tools
# Replace placeholders: {{jwtToken}}, {{userUuid}}, {{ownerUuid}}, {{ownerId}}, {{deviceId}}, {{packageId}}, {{orderId}}, {{transId}}, {{tasmotaId}}

### https://smartcb-api.laoapps.com/api/bookings/owner/delete/1
POST https://smartcb-api.laoapps.com/api/bookings/owner/delete/1
Content-Type: application/json
Authorization: Bearer {{jwtToken}}
x-owner: true

{

}

### 
GET https://smartcb-api.laoapps.com/api/bookings/my
Content-Type: application/json
Authorization: Bearer {{suckToken}}

{

}

### Add New Device
POST http://{{host}}/api/devices
Content-Type: application/json
Authorization: Bearer {{jwtToken}}

{
  "name": "Test Device",
  "tasmotaId": "{{tasmotaId}}",
  "ownerUuid": "{{ownerUuid}}",
  "zone": "Test Zone"
}

### Add Package (Time Duration)
POST http://{{host}}/api/packages
Content-Type: application/json
Authorization: Bearer {{jwtToken}}

{
  "name": "30 Minute Package",
  "ownerId": {{ownerId}},
  "price": 10.0,
  "conditionType": "time_duration",
  "conditionValue": 30
}

### Add Package (Energy Consumption)
POST http://{{host}}/api/packages
Content-Type: application/json
Authorization: Bearer {{jwtToken}}

{
  "name": "5 kWh Package",
  "ownerId": {{ownerId}},
  "price": 15.0,
  "conditionType": "energy_consumption",
  "conditionValue": 5
}

### GET packages by ownerID
GET https://{{host}}/api/schedule-packages/findByOwnerID/1
Content-Type: application/json
Authorization: Bearer {{jwtToken}}

{

}

### test findAllActiveDevices
POST https://{{host}}/api/orders/findAllActiveDevices
Content-Type: application/json
token: 96fd8df2fe85122f48a71a0b63d3d8e547522e10b91936550965698b69d49609

{
  
}
### test deleteActiveDevice
POST https://{{host}}/api/orders/deleteActiveDevice
Content-Type: application/json
Authorization: Bearer {{jwtToken}}

{
  "deviceID":4
}

### test update devices
POST https://{{host}}/api/schedule-packages/findByPackageIDsHMVending
Content-Type: application/json
token: 96fd8df2fe85122f48a71a0b63d3d8e547522e10b91936550965698b69d49609

{
  "packages": [1,5,6]
}

### test update devices
PUT https://{{host}}/api/devices/1
Content-Type: application/json
Authorization: Bearer {{jwtToken}}
x-owner: true

{
  "name": "number3",
  "tasmotaId": "tongou_3B0900",
  "zone": "test",
  "groupId": 1
}

### test clear device rule
POST https://{{host}}/api/devices/clearDeviceRule
Content-Type: application/json
Authorization: Bearer {{jwtToken}}

{
  "deviceId": 3,
  "relay": 1
}

### test Order
POST https://{{host}}/api/orders/testneworder
Content-Type: application/json
Authorization: Bearer {{jwtToken}}

{
  "packageId": 5,
  "deviceId": 3,
  "relay": 1
}

### Create Order
POST https://{{host}}/api/orders
Content-Type: application/json
Authorization: Bearer {{jwtToken}}

{
  "packageId": {{packageId}},
  "deviceId": {{deviceId}},
  "relay": 1,
  "userUuid": "{{userUuid}}"
}

### Get Orders
POST https://{{host}}/api/orders/list
Content-Type: application/json
Authorization: Bearer {{jwtToken}}

{

}

### Get Order by ID
GET http://{{host}}/api/orders/{{orderId}}
Content-Type: application/json
Authorization: Bearer {{jwtToken}}

### Pay Order
POST http://{{host}}/api/orders/pay
Content-Type: application/json

{
  "transid": "{{transId}}",
  "data": {
    "paymentDetails": "Test Payment"
  }
}

### Start Device Manually (No Conditions)
POST http://{{host}}/api/devices/control
Content-Type: application/json
Authorization: Bearer {{jwtToken}}

{
  "deviceId": {{deviceId}},
  "command": "ON",
  "relay": 1
}

### Stop Device Manually (No Conditions)
POST http://{{host}}/api/devices/control
Content-Type: application/json
Authorization: Bearer {{jwtToken}}

{
  "deviceId": {{deviceId}},
  "command": "OFF",
  "relay": 1
}

### Start Device with Duration (30 minutes)
POST http://{{host}}/api/devices/control
Content-Type: application/json
Authorization: Bearer {{jwtToken}}

{
  "deviceId": {{deviceId}},
  "command": "ON",
  "relay": 1,
  "conditionType": "time_duration",
  "conditionValue": 30
}

### Start Device with Energy Limit (5 kWh)
POST http://{{host}}/api/devices/control
Content-Type: application/json
Authorization: Bearer {{jwtToken}}

{
  "deviceId": {{deviceId}},
  "command": "ON",
  "relay": 1,
  "conditionType": "energy_consumption",
  "conditionValue": 5
}

### Stop Device with Duration/Energy (Complete Order)
POST http://{{host}}/api/orders/complete
Content-Type: application/json

{
  "deviceId": {{deviceId}}
}