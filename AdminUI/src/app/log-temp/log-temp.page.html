<ion-header>
  <ion-toolbar color="primary">
    <ion-title>Temperature Logs</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div class="container">

    <ion-card class="filter-card">
      <ion-card-header>
        <ion-card-title>Select Date Range</ion-card-title>
      </ion-card-header>

      <ion-card-content>
        <ion-item>
          <ion-label position="stacked">From Date</ion-label>
          <ion-datetime presentation="date-time" [(ngModel)]="fromDate" displayFormat="YYYY-MM-DD HH:mm">
          </ion-datetime>
        </ion-item>

        <ion-item>
          <ion-label position="stacked">To Date</ion-label>
          <ion-datetime presentation="date-time" [(ngModel)]="toDate" displayFormat="YYYY-MM-DD HH:mm">
          </ion-datetime>
        </ion-item>

        <ion-button expand="block" color="primary" class="ion-margin-top" (click)="fetchReport()" [disabled]="loading">
          <ion-spinner *ngIf="loading" name="crescent"></ion-spinner>
          <span *ngIf="!loading">Process</span>
        </ion-button>
      </ion-card-content>
    </ion-card>

    <ion-card *ngIf="rows.length > 0">
      <ion-card-header>
        <ion-card-title>Results ({{ rows.length }})</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-grid>
          <ion-row class="header-row">
            <ion-col size="3">Created At</ion-col>
            <ion-col size="2">Device</ion-col>
            <ion-col size="2">Temperature</ion-col>

          </ion-row>

          <ion-row *ngFor="let row of rows">
            <ion-col size="3">{{row.createdAt | date: 'yyyy-MM-dd HH:mm:ss':'+7'}}</ion-col>
            <ion-col size="2">{{ row.mstatus?.device }}</ion-col>
            <ion-col size="2">
              <ion-badge [color]="getTemperatureColor(row.mstatus?.temperature)">
                {{ row.mstatus?.temperature }}Â°C
              </ion-badge>
            </ion-col>

          </ion-row>
        </ion-grid>
      </ion-card-content>
    </ion-card>

    <div *ngIf="!loading && rows.length === 0" class="empty-state ion-text-center ion-padding">
      <ion-icon name="thermometer-outline" size="large" color="medium"></ion-icon>
      <p>No temperature data found</p>
    </div>

  </div>
</ion-content>